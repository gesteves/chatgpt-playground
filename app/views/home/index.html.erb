<section class="hero is-small">
  <div class="hero-body">
    <h1 class="title">Today’s Playlists</h1>
    <p class="subtitle">Here are your playlists for today’s workouts.</p>
    <% if Rails.env.development? %>
      <div class="field is-grouped">
        <%= button_to destroy_all_playlists_path, method: :delete, data: { turbo_confirm: 'Are you sure you want to delete all playlists?' }, disabled: @todays_playlists.any?(&:processing) || @todays_playlists.blank?, class: "button is-danger" do %>
          <span class="icon">
            <i class="fa-solid fa-circle-xmark"></i>
          </span>
          <span>Delete all</span>
        <% end %>
      </div>
    <% end %>
    <hr>
  </div>
</section>

<section class="container is-max-desktop">
  <%= turbo_frame_tag "music_request" do %>
    <%= render partial: 'home/music_request_form', locals: { music_request: @music_request, todays_playlists: @todays_playlists } %>
  <% end %>
  
  <%= turbo_frame_tag "playlists" do %>
    <hr>
    <% if @todays_playlists.any? %>
      <% @todays_playlists.each do |playlist| %>
        <%= render partial: 'home/playlist', locals: { playlist: playlist } %>
      <% end %>
    <% end %>
  <% end %>
</section>

<%= turbo_stream_from "playlists:index:user:#{current_user.id}" %>
<%= turbo_stream_from "music_requests:form:user:#{current_user.id}" %>
